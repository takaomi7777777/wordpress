(function(f){var a=null;var d="",e="";var g=this;var o=false;var h=false;var k=null;var n=new Array();var m=new Array();var b=0;var c=false;var j=new Array();f.fn.bgStretcher=function(r){if(f(".bgstretcher-page").length||f(".bgstretcher-area").length){if(typeof(console)!=="undefined"&&console!=null){console.log("More than one bgStretcher")}return false}r=f.extend({},f.fn.bgStretcher.defaults,r);f.fn.bgStretcher.settings=r;function q(v){if(!r.images.length){return}p(v);e="#"+r.imageContainer;a=f(e);d="#"+r.imageContainer+" LI";f(d).hide().css({"z-index":1,overflow:"hidden"});if(!a.length){return}f(window).resize(function(){s(v)});s(v);var w=0;if(r.transitionEffect=="simpleSlide"){if(r.sequenceMode=="random"){if(typeof(console)!=="undefined"&&console!=null){console.log("Effect 'simpleSlide' don't be to use with mode random.");console.log("Mode was automaticly set in normal.")}}f(d).css({"float":"left",position:"static"});f(d).show();if(f.fn.bgStretcher.settings.slideDirection=="NW"||f.fn.bgStretcher.settings.slideDirection=="NE"){f.fn.bgStretcher.settings.slideDirection="N"}if(f.fn.bgStretcher.settings.slideDirection=="SW"||f.fn.bgStretcher.settings.slideDirection=="SE"){f.fn.bgStretcher.settings.slideDirection="S"}if(f.fn.bgStretcher.settings.slideDirection=="S"||f.fn.bgStretcher.settings.slideDirection=="E"){r.sequenceMode="back";f(d).removeClass("bgs-current");f(d).eq(f(d).length-f.fn.bgStretcher.settings.startElementIndex-1).addClass("bgs-current");if(f.fn.bgStretcher.settings.slideDirection=="E"){l=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).width()*(-1);t=0}else{t=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).height()*(-1);l=0}f(e+" UL").css({left:l+"px",top:t+"px"})}else{r.sequenceMode="normal";if(f.fn.bgStretcher.settings.startElementIndex!=0){if(f.fn.bgStretcher.settings.slideDirection=="N"){t=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).height()*(-1);l=0}else{l=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).width()*(-1);t=0;console.log(l)}f(e+" UL").css({left:l+"px",top:t+"px"})}}}if(f(r.buttonNext).length||f(r.buttonPrev).length||f(r.pagination).length){if(r.sequenceMode=="random"){if(typeof(console)!=="undefined"&&console!=null){console.log("Don't use random mode width prev-button, next-button and pagination.")}}else{if(f(r.buttonPrev).length){f(r.buttonPrev).addClass("bgStretcherNav bgStretcherNavPrev");f(r.buttonPrev).click(function(){f.fn.bgStretcher.buttonSlide("prev")})}if(f(r.buttonNext).length){f(r.buttonNext).addClass("bgStretcherNav bgStretcherNavNext");f(r.buttonNext).click(function(){f.fn.bgStretcher.buttonSlide("next")})}if(f(r.pagination).length){f.fn.bgStretcher.pagination()}}}if(r.sequenceMode=="random"){var u=Math.floor(Math.random()*f(d).length);f.fn.bgStretcher.buildRandom(u);if(r.transitionEffect!="simpleSlide"){f.fn.bgStretcher.settings.startElementIndex=u}w=u}else{if(f.fn.bgStretcher.settings.startElementIndex>(f(d).length-1)){f.fn.bgStretcher.settings.startElementIndex=0}w=f.fn.bgStretcher.settings.startElementIndex;if(r.transitionEffect=="simpleSlide"){if(f.fn.bgStretcher.settings.slideDirection=="S"||f.fn.bgStretcher.settings.slideDirection=="E"){w=f(d).length-1-f.fn.bgStretcher.settings.startElementIndex}}}f(d).eq(w).show().addClass("bgs-current");f.fn.bgStretcher.loadImg(f(d).eq(w));if(r.slideShow&&f(d).length>1){k=setTimeout("jQuery.fn.bgStretcher.slideShow('"+jQuery.fn.bgStretcher.settings.sequenceMode+"', -1)",r.nextSlideDelay)}}function s(D){var F=0;var y=0;var H=0;var v=0;if(f("BODY").hasClass("bgStretcher-container")){F=f(window).width();y=f(window).height();if((f.browser.msie)&&(parseInt(jQuery.browser.version)==6)){f(window).scroll(function(){f("#"+r.imageContainer).css("top",f(window).scrollTop())})}}else{f(".bgstretcher").css("position","absolute").css("top","0px");F=D.width();y=D.height()}var E=0,x=0;var w=0;if(r.maxWidth!="auto"){if(F>r.maxWidth){w=(F-r.maxWidth)/2;v=r.maxWidth}else{v=F}}else{v=F}if(r.maxHeight!="auto"){if(y>r.maxHeight){H=r.maxHeight}else{H=y}}else{H=y}a.width(v);a.height(H);if(!r.resizeProportionally){E=H;x=H}else{var G=r.imageWidth,B=r.imageHeight;var C=B/G;E=v;x=Math.round(v*C);if(x<H){x=H;E=Math.round(x/C)}}var u=0;var J=0;var I;if(f.fn.bgStretcher.settings.anchoring!="left top"){I=(f.fn.bgStretcher.settings.anchoring).split(" ");if(I[0]=="right"){u=(F-v)}else{if(I[0]=="center"){u=Math.round((F-v)/2)}}if(I[1]=="bottom"){J=(y-H)}else{if(I[1]=="center"){J=Math.round((y-H)/2)}}a.css("marginLeft",u+"px").css("marginTop",J+"px")}u=0;J=0;if(f.fn.bgStretcher.settings.anchoringImg!="left top"){I=(f.fn.bgStretcher.settings.anchoringImg).split(" ");if(I[0]=="right"){u=(v-E)}else{if(I[0]=="center"){u=Math.round((v-E)/2)}}if(I[1]=="bottom"){J=(H-x)}else{if(I[1]=="center"){J=Math.round((H-x)/2)}}}j.mar_left=u;j.mar_top=J;if(a.find("LI:first").hasClass("swf-mode")){var z=a.find("LI:first").html();a.find("LI:first").html('<div id="bgstretcher-flash">&nbsp;</div>');var A=new SWFObject("flash/stars.swf","flash-obj",v,H,"9");A.addParam("wmode","transparent");A.write("bgstretcher-flash")}j.imgW=E;j.imgH=x;if(!r.resizeAnimate){a.children("UL").children("LI.img-loaded").find("IMG").css({marginLeft:j.mar_left+"px",marginTop:j.mar_top+"px"});a.children("UL").children("LI.img-loaded").find("IMG").css({width:j.imgW+"px",height:j.imgH+"px"})}else{a.children("UL").children("LI.img-loaded").find("IMG").animate({marginLeft:j.mar_left+"px",marginTop:j.mar_top+"px"},"normal");a.children("UL").children("LI.img-loaded").find("IMG").animate({width:j.imgW+"px",height:j.imgH+"px"},"normal")}f(d).width(a.width()).height(a.height());if(f.fn.bgStretcher.settings.transitionEffect=="simpleSlide"){if(f.fn.bgStretcher.settings.slideDirection=="W"||f.fn.bgStretcher.settings.slideDirection=="E"){a.children("UL").width(a.width()*f(d).length).height(a.height());if(f(e+" LI").index(f(e+" LI.bgs-current"))!=-1){l=f(e+" LI").index(f(e+" LI.bgs-current"))*a.width()*(-1);a.children("UL").css({left:l+"px"})}}else{a.children("UL").height(a.height()*f(d).length).width(a.width());if(f(e+" LI").index(f(e+" LI.bgs-current"))!=-1){t=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).height()*(-1);a.children("UL").css({top:t+"px"})}}}}function p(u){var v="";var w;u.each(function(){f(this).wrapInner('<div class="bgstretcher-page" />').wrapInner('<div class="bgstretcher-area" />');v='<div id="'+r.imageContainer+'" class="bgstretcher"><ul>';if(r.images.length){var x=r.images[0].split(".");x=x[x.length-1];if(x!="swf"){var y=0;for(i=0;i<r.images.length;i++){if(r.transitionEffect=="simpleSlide"&&r.sequenceMode=="back"){y=r.images.length-1-i}else{y=i}if(f.fn.bgStretcher.settings.preloadImg){if(r.titles[y]&&r.urls[y]){v+='<li><a href="'+r.urls[y]+'"><span class="image-path">'+r.images[y]+'</span></a><span class="bgstr-tooltip">'+r.titles[y]+"</span>"}else{v+='<li><span class="image-path">'+r.images[y]+"</span>"}}else{if(r.titles[y]&&r.urls[y]){v+='<li class="img-loaded"><a href="'+r.urls[y]+'"><img src="'+r.images[y]+'" /></a><span class="bgstr-tooltip">'+r.titles[y]+"</span>"}else{v+='<li class="img-loaded"><img src="'+r.images[y]+'" />'}}v+="</li>"}}else{v+='<li class="swf-mode">'+r.images[0]+"</li>"}}v+="</ul></div>";w=f(this).children(".bgstretcher-area");f(v).prependTo(w);w.css({position:"relative"});w.children(".bgstretcher-page").css({position:"relative","z-index":3})})}this.addClass("bgStretcher-container");q(this)};f.fn.bgStretcher.loadImg=function(p){if(p.hasClass("img-loaded")){return true}p.find("SPAN.image-path").each(function(){var u=f(this).html();var s="";var r=f(this).parent();var q=new Image();f(q).load(function(){f(this).hide();r.prepend(this);f(this).fadeIn("100")}).error(function(){}).attr("src",u).attr("alt",s);f(q).css({marginLeft:j.mar_left+"px",marginTop:j.mar_top+"px"});f(q).css({width:j.imgW+"px",height:j.imgH+"px"})});p.addClass("img-loaded");return true};f.fn.bgStretcher.play=function(){o=false;f.fn.bgStretcher._clearTimeout();f.fn.bgStretcher.slideShow(f.fn.bgStretcher.settings.sequenceMode,-1)};f.fn.bgStretcher._clearTimeout=function(){if(k!=null){clearTimeout(k);k=null}};f.fn.bgStretcher.pause=function(){o=true;f.fn.bgStretcher._clearTimeout()};f.fn.bgStretcher.sliderDestroy=function(){var p=f(".bgstretcher-page").html();f(".bgStretcher-container").html("").html(p).removeClass("bgStretcher-container");f.fn.bgStretcher._clearTimeout();o=false};f.fn.bgStretcher.slideShow=function(p,q){h=true;if(f(d).length<2){return true}var s=f(e+" LI.bgs-current");var r;f(s).stop(true,true);if(q==-1){switch(p){case"back":r=s.prev();if(!r.length){r=f(e+" LI:last")}break;case"random":if(b==f(e+" LI").length){f.fn.bgStretcher.buildRandom(n[f(e+" LI").length-1]);b=0}r=f(e+" LI").eq(n[b]);b++;break;default:r=s.next();if(!r.length){r=f(e+" LI:first")}}}else{r=f(e+" LI").eq(q)}f(e+" LI").removeClass("bgs-current");f.fn.bgStretcher.loadImg(r);r.addClass("bgs-current");switch(f.fn.bgStretcher.settings.transitionEffect){case"fade":f.fn.bgStretcher.effectFade(s,r);break;case"simpleSlide":f.fn.bgStretcher.simpleSlide();break;case"superSlide":f.fn.bgStretcher.superSlide(s,r,p);break;default:f.fn.bgStretcher.effectNone(s,r)}if(f(f.fn.bgStretcher.settings.pagination).find("LI").length){f(f.fn.bgStretcher.settings.pagination).find("LI.showPage").removeClass("showPage");f(f.fn.bgStretcher.settings.pagination).find("LI").eq(f(e+" LI").index(f(e+" LI.bgs-current"))).addClass("showPage")}if(f.fn.bgStretcher.settings.callbackfunction){if(typeof f.fn.bgStretcher.settings.callbackfunction=="function"){f.fn.bgStretcher.settings.callbackfunction.call()}}if(!o){k=setTimeout("jQuery.fn.bgStretcher.slideShow('"+jQuery.fn.bgStretcher.settings.sequenceMode+"', -1)",jQuery.fn.bgStretcher.settings.nextSlideDelay)}};f.fn.bgStretcher.effectNone=function(q,p){p.show();q.hide();h=false};f.fn.bgStretcher.effectFade=function(q,p){p.fadeIn(f.fn.bgStretcher.settings.slideShowSpeed);q.fadeOut(f.fn.bgStretcher.settings.slideShowSpeed,function(){h=false})};f.fn.bgStretcher.simpleSlide=function(){var q,p;switch(f.fn.bgStretcher.settings.slideDirection){case"N":case"S":q=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).height()*(-1);p=0;break;default:p=f(e+" LI").index(f(e+" LI.bgs-current"))*f(e).width()*(-1);q=0}f(e+" UL").animate({left:p+"px",top:q+"px"},f.fn.bgStretcher.settings.slideShowSpeed,function(){h=false})};f.fn.bgStretcher.superSlide=function(u,s,p){var r,q;switch(f.fn.bgStretcher.settings.slideDirection){case"S":r=f(e).height();q=0;break;case"E":r=0;q=f(e).width();break;case"W":r=0;q=f(e).width()*(-1);break;case"NW":r=f(e).height()*(-1);q=f(e).width()*(-1);break;case"NE":r=f(e).height()*(-1);q=f(e).width();break;case"SW":r=f(e).height();q=f(e).width()*(-1);break;case"SE":r=f(e).height();q=f(e).width();break;default:r=f(e).height()*(-1);q=0}if(p=="back"){s.css({"z-index":2,top:r+"px",left:q+"px"});s.show();s.animate({left:"0px",top:"0px"},f.fn.bgStretcher.settings.slideShowSpeed,function(){u.hide();f(this).css({"z-index":1});h=false})}else{u.css("z-index",2);s.show();u.animate({left:q+"px",top:r+"px"},f.fn.bgStretcher.settings.slideShowSpeed,function(){f(this).hide().css({"z-index":1,top:"0px",left:"0px"});h=false})}};f.fn.bgStretcher.buildRandom=function(u){var q=f(d).length;var s,r,p;for(s=0;s<q;s++){n[s]=s;m[s]=Math.random()*q}for(s=0;s<q;s++){for(r=0;r<(q-s-1);r++){if(m[r]>m[r+1]){p=m[r];m[r]=m[r+1];m[r+1]=p;p=n[r];n[r]=n[r+1];n[r+1]=p}}}if(n[0]==u){p=n[0];n[0]=n[q-1];n[q-1]=p}};f.fn.bgStretcher.buttonSlide=function(p){if(h||(f(d).length<2)){return false}var q="";if(p=="prev"){q="back";if(f.fn.bgStretcher.settings.sequenceMode=="back"){q="normal"}}else{q=f.fn.bgStretcher.settings.sequenceMode}f(d).stop(true,true);f.fn.bgStretcher._clearTimeout();f.fn.bgStretcher.slideShow(q,-1);return false};f.fn.bgStretcher.pagination=function(){var p=f(d).length;var q="";var r=0;if(p>0){q+="<ul>";for(r=0;r<p;r++){q+='<li><a href="javascript:;">'+(r+1)+"</a></li>"}q+="</ul>";f(f.fn.bgStretcher.settings.pagination).html(q);f(f.fn.bgStretcher.settings.pagination).find("LI:first").addClass("showPage");f(f.fn.bgStretcher.settings.pagination).find("A").click(function(){if(f(this).parent().hasClass("showPage")){return false}f(d).stop(true,true);f.fn.bgStretcher._clearTimeout();f.fn.bgStretcher.slideShow(f.fn.bgStretcher.settings.sequenceMode,f(f.fn.bgStretcher.settings.pagination).find("A").index(f(this)));return false})}return false};f.fn.bgStretcher.defaults={imageContainer:"bgstretcher",resizeProportionally:true,resizeAnimate:false,images:[],imageWidth:1024,imageHeight:768,maxWidth:"auto",maxHeight:"auto",nextSlideDelay:3000,slideShowSpeed:"normal",slideShow:true,transitionEffect:"fade",slideDirection:"N",sequenceMode:"normal",titles:[],urls:[],descriptions:[],buttonPrev:"",buttonNext:"",pagination:"",anchoring:"left top",anchoringImg:"left top",preloadImg:false,startElementIndex:0,callbackfunction:null};f.fn.bgStretcher.settings={}})(jQuery);